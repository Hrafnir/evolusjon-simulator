<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Natural Selection Lab — Klar visning</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="app">
    <header class="bar">
      <div>
        <h1>Natural Selection Lab</h1>
        <small>Tydelig og tilgjengelig: form, hale, strektykkelse og kontrast viser egenskapene.</small>
      </div>
      <div class="btnbar">
        <button class="btn" id="playPause">Start</button>
        <button class="btn ghost" id="stepGen">Steg (1 gen)</button>
        <button class="btn alt" id="resetBtn">Reset</button>
      </div>
    </header>

    <aside class="sidebar">
      <section class="card">
        <h2>Populasjon & genetikk</h2>
        <div class="row"><label>Antall individer: <b id="lblPop">120</b></label><input id="popSize" type="range" min="20" max="300" step="10" value="120"></div>
        <div class="row"><label>Mutasjonsrate (%): <b id="lblMut">4</b></label><input id="mutation" type="range" min="0" max="20" step="1" value="4"></div>
        <div class="row"><label>Arvbarhet (0–1): <b id="lblHer">0.6</b></label><input id="heritability" type="range" min="0" max="1" step="0.05" value="0.6"></div>
        <div class="row"><label>Generasjonslengde (ms): <b id="lblTick">900</b></label><input id="tick" type="range" min="200" max="2000" step="100" value="900"></div>
        <div class="row"><label><input id="mono" type="checkbox"> Monokrom visning (tilgjengelighet)</label></div>
      </section>

      <section class="card">
        <h2>Miljø & seleksjon</h2>
        <div class="row"><label>Miljøfarge</label><input id="envColor" type="color" value="#1f2a44"></div>
        <div class="row"><label>Predatortrykk: <b id="lblPred">0.5</b></label><input id="predation" type="range" min="0" max="1" step="0.05" value="0.5"></div>
        <div class="row"><label>Mattilgang: <b id="lblFood">0.7</b></label><input id="food" type="range" min="0" max="1" step="0.05" value="0.7"></div>
        <div class="row"><label>Seleksjonsstyrke: <b id="lblSel">0.6</b></label><input id="selection" type="range" min="0" max="1" step="0.05" value="0.6"></div>

        <div class="grid2" style="margin-top:8px">
          <label><input type="checkbox" id="traitSize" checked> Størrelse teller</label>
          <label><input type="checkbox" id="traitSpeed" checked> Hastighet teller</label>
          <label><input type="checkbox" id="traitColor" checked> Kamuflasje teller</label>
          <label><input type="checkbox" id="costSize" checked> Energi-kost for stor kropp</label>
        </div>
      </section>

      <section class="card">
        <h2>Omveltende hendelser</h2>
        <div class="btnbar">
          <button class="btn ghost" data-shock="drought">Tørke</button>
          <button class="btn ghost" data-shock="newPred">Ny predator</button>
          <button class="btn ghost" data-shock="colorShift">Habitat bytter farge</button>
          <button class="btn ghost" data-shock="coldSnap">Kaldt år</button>
          <button class="btn ghost" data-shock="abundance">Mye mat</button>
        </div>
        <p class="tiny">Bruk disse for «aha-øyeblikk» i timen.</p>
      </section>

      <section class="card legend">
        <h2>Hvordan lese figurene</h2>
        <div class="legend-row">
          <span class="shape demo circle"></span> Sirkel = størrelses-dominant
        </div>
        <div class="legend-row">
          <span class="shape demo triangle"></span> Trekant = farts-dominant (lengre hale = raskere)
        </div>
        <div class="legend-row">
          <span class="shape demo square"></span> Kvadrat = kamuflasje-dominant (matt = godt kamuflert)
        </div>
        <div class="legend-row">
          <span class="bar-demo"><span class="bar-fill" style="width:66%"></span></span> Fitness-bar (høy = større sjanse for å bli forelder)
        </div>
      </section>
    </aside>

    <main class="main">
      <div class="card stage">
        <canvas id="world" aria-label="Simulasjonsflate"></canvas>
        <div id="banner" class="banner" aria-live="polite"></div>
        <div id="tooltip" class="tooltip" role="dialog" aria-hidden="true"></div>
      </div>

      <div class="card kpis">
        <div class="kpi">
          <h3>Generasjon</h3><p id="kGen">0</p>
        </div>
        <div class="kpi">
          <h3>Overlevelse (%)</h3><p id="kSurv">100</p>
        </div>
        <div class="kpi">
          <h3>Snitt størrelse</h3><p id="kSize">0.50</p>
        </div>
        <div class="kpi">
          <h3>Snitt hastighet</h3><p id="kSpeed">0.50</p>
        </div>
        <div class="kpi">
          <h3>Snitt kamuflasje</h3><p id="kCamo">0.50</p>
        </div>
        <div class="kpi">
          <h3>Fenotyper</h3>
          <p><span id="countSize">0</span> ⭕︎ &nbsp; <span id="countSpeed">0</span> ▲ &nbsp; <span id="countCamo">0</span> ■</p>
        </div>
      </div>
      <canvas id="chart" height="160" aria-label="Utviklingsgrafer"></canvas>
    </main>

    <footer class="bar">
      <div>Form → Dominerende egenskap | Hale → Hastighet | Strek → Størrelse | Kontrast → Kamuflasje</div>
      <div class="tiny">Fri bruk og endring. Ingen avhengigheter.</div>
    </footer>
  </div>

  <script type="module" src="./sim.js"></script>
</body>
</html>
